<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EnhancementDefinition 관리 가이드 (Firestore)</title>
  <style>
    :root {
      color-scheme: light dark;
      font-family: "Noto Sans KR", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      padding: 1.5rem;
      background: #0f172a;
      color: #e2e8f0;
    }

    .top-nav {
      position: sticky;
      top: 0;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      padding: 0.9rem 1.5rem;
      margin: -1.5rem -1.5rem 1.25rem;
      background: rgba(11, 18, 32, 0.8);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid #1f2937;
    }

    .nav-brand {
      font-weight: 800;
      letter-spacing: -0.01em;
    }

    .nav-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .nav-link {
      color: #cbd5e1;
      text-decoration: none;
      padding: 0.45rem 0.8rem;
      border-radius: 10px;
      border: 1px solid transparent;
      transition: background 0.15s ease, border-color 0.15s ease, color 0.15s ease;
    }

    .nav-link:hover {
      background: #111827;
      border-color: #1f2937;
      color: #e2e8f0;
    }

    .nav-link.active {
      background: linear-gradient(90deg, #3b82f6, #06b6d4);
      color: #0b1220;
      border-color: transparent;
    }

    h1 {
      margin-top: 0;
    }

    .container {
      display: grid;
      gap: 1rem;
    }

    .card {
      background: #111827;
      border: 1px solid #1f2937;
      border-radius: 12px;
      padding: 1rem 1.25rem;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .card h2 {
      margin-top: 0;
      margin-bottom: 0.5rem;
    }

    .card ol,
    .card ul {
      margin: 0.35rem 0 0.75rem 1.1rem;
      padding-left: 0.4rem;
      line-height: 1.6;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      padding: 0.35rem 0.65rem;
      border-radius: 999px;
      background: #0b1220;
      border: 1px solid #1f2937;
      color: #cbd5e1;
      font-size: 0.95rem;
      margin-right: 0.35rem;
    }

    code {
      padding: 0.2rem 0.4rem;
      border-radius: 6px;
      background: #0b1220;
      border: 1px solid #1f2937;
    }

    .muted {
      color: #94a3b8;
      font-size: 0.95rem;
    }
  </style>
</head>
<body>
  <nav class="top-nav">
    <div class="nav-brand">Stat 관리 도구</div>
    <div class="nav-links">
      <a class="nav-link" href="base-stats-firestore.html">BaseStat 프리셋</a>
      <a class="nav-link" href="growth-base-stats-firestore.html">GrowthBaseStat 프리셋</a>
      <a class="nav-link" href="combat-stats-firestore.html">CombatStats 관리</a>
      <a class="nav-link" href="combat-dps-tester.html">Combat DPS 테스트</a>
      <a class="nav-link active" href="enhancement-definitions-firestore.html">EnhancementDefinition 가이드</a>
    </div>
  </nav>

  <main class="container">
    <header>
      <h1>EnhancementDefinition Firestore 페이지 사용 가이드</h1>
      <p class="muted">
        장비 강화 효과(EnhancementDefinition) 프리셋을 Firestore에서 불러오고 관리하는 페이지를 위한 상세 안내입니다.
        모든 작업 전에 <strong>Firebase 설정</strong>을 먼저 입력해 주세요.
      </p>
    </header>

    <section class="card">
      <h2>1. 사전 준비</h2>
      <ol>
        <li><span class="badge">필수</span>페이지에 접속하면 Firebase 설정 입력 모달이 나타납니다. 프로젝트의 <strong>API Key, Auth Domain</strong> 등 콘솔에서 제공하는 값을 정확히 입력하세요.</li>
        <li>한 번 입력하면 쿠키로 30일 동안 저장되어 재방문 시 자동으로 채워집니다. 값이 바뀌면 모달에서 수정 후 다시 저장하세요.</li>
        <li>Firestore 보안 규칙에서 읽기/쓰기 권한이 허용된 계정인지 확인합니다. 제한된 환경이면 임시 서비스 계정이나 로컬 에뮬레이터를 사용하세요.</li>
      </ol>
    </section>

    <section class="card">
      <h2>2. 페이지 주요 영역</h2>
      <ul>
        <li><strong>검색 및 필터</strong>: 이름, 등급, 적용 대상(무기/방어구 등)으로 EnhancementDefinition 목록을 필터링합니다.</li>
        <li><strong>목록 테이블</strong>: Firestore의 <code>enhancementDefinitions</code> 컬렉션을 불러와 주요 필드(이름, 부위, 수치 타입, 기본값, 최대 레벨 등)를 표시합니다. 열 헤더를 눌러 정렬할 수 있습니다.</li>
        <li><strong>세부 정보/편집 패널</strong>: 행을 클릭하면 상세 필드가 오른쪽 패널에 열립니다. 여기서 수치를 수정하거나 효과를 추가/삭제하고, 초안으로 저장하기 전에 입력값 검증 결과를 즉시 확인할 수 있습니다.</li>
        <li><strong>변경 이력 표시</strong>: 최근 수정자와 수정 시각을 함께 보여 주어 협업 시 충돌을 피할 수 있습니다.</li>
      </ul>
    </section>

    <section class="card">
      <h2>3. 기본 사용 흐름</h2>
      <ol>
        <li><span class="badge">연결</span>Firebase 설정 입력 → Firestore 초기화 완료 메시지 확인.</li>
        <li><span class="badge">조회</span>검색창/필터를 조합해 원하는 EnhancementDefinition을 찾습니다.</li>
        <li><span class="badge">검토</span>행을 선택해 수치, 적용 조건, 설명 등의 세부 정보를 확인합니다.</li>
        <li><span class="badge">수정</span>필드 값을 변경한 뒤 <em>저장</em> 버튼을 누르면 Firestore에 적용됩니다. 실패 시 오류 메시지를 읽고 권한 및 네트워크 상태를 점검하세요.</li>
        <li><span class="badge">추가</span>상단의 "새 프리셋" 버튼으로 빈 양식을 열고 필수 필드를 모두 입력합니다. 저장 전에 중복 이름이 없는지 확인합니다.</li>
        <li><span class="badge">삭제</span>더 이상 사용하지 않는 항목은 삭제 버튼으로 제거합니다. 즉시 반영되므로 팀과 충분히 공유 후 진행하세요.</li>
      </ol>
    </section>

    <section class="card">
      <h2>4. 입력 필드 규칙</h2>
      <ul>
        <li><strong>name</strong>: 고유한 식별자이자 표시 이름. 공백/대소문자를 포함해도 되지만 중복은 허용되지 않습니다.</li>
        <li><strong>slot</strong>: 적용 부위 (예: <code>weapon</code>, <code>armor</code>, <code>accessory</code>). 사전에 정의된 ENUM 값만 선택 가능합니다.</li>
        <li><strong>valueType</strong>: 수치 타입 (퍼센트/고정/스케일링 등) 을 명확히 지정합니다.</li>
        <li><strong>baseValue · maxValue · step</strong>: 강화 레벨별 계산에 사용되는 수치. 음수/비정상 값 입력 시 저장이 거부됩니다.</li>
        <li><strong>description</strong>: 인게임 표현과 동일하게 작성해 QA 과정에서 사용자 혼란을 줄입니다.</li>
      </ul>
    </section>

    <section class="card">
      <h2>5. 문제 해결</h2>
      <ul>
        <li><strong>설정 모달이 반복해서 뜨는 경우</strong>: 일부 값이 비어 있거나 쿠키 삭제 정책이 적용되었을 수 있습니다. 모든 필드를 다시 입력 후 저장하세요.</li>
        <li><strong>데이터가 보이지 않을 때</strong>: Firestore 규칙, 네트워크 연결, 컬렉션 경로(<code>enhancementDefinitions</code>)를 확인합니다.</li>
        <li><strong>권한 오류</strong>: 콘솔에서 인증된 사용자 또는 서비스 계정에 읽기/쓰기 권한을 부여하고 다시 시도합니다.</li>
      </ul>
    </section>

    <section class="card">
      <h2>6. 운영 팁</h2>
      <ul>
        <li>대량 수정은 먼저 로컬에서 JSON으로 내보낸 뒤 스크립트로 검증하고 업로드하세요.</li>
        <li>실험용 변경은 별도 <code>staging</code> 프로젝트에서 검증 후 운영 프로젝트에 반영합니다.</li>
        <li>계산식 변경 시 Combat DPS 테스트 페이지와 결과가 일관되도록 상호 검증합니다.</li>
      </ul>
    </section>
  </main>
</body>
</html>
